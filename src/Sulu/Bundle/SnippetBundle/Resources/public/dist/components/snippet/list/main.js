define(["sulusnippet/components/snippet/main","sulucontent/components/copy-locale-overlay/main","sulucontent/components/open-ghost-overlay/main"],function(a,b,c){"use strict";var d=['<div id="list-toolbar-container" class="list-toolbar-container"></div>','<div id="snippet-list" class="datagrid-container"></div>','<div id="dialog"></div>'].join(""),e=function(){return a.call(this),this};return e.prototype=Object.create(a.prototype),e.prototype.constructor=a,e.prototype.view=!0,e.prototype.stickyToolbar=!0,e.prototype.layout={content:{width:"max"},sidebar:!1},e.prototype.header=function(){return{noBack:!0,title:"snippets.snippet.title",underline:!1,toolbar:{buttons:{add:{},deleteSelected:{},"export":{options:{urlParameter:{flat:!0},url:"/admin/api/snippets.csv"}}},languageChanger:{preSelected:this.options.language}}}},e.prototype.initialize=function(){this.bindModelEvents(),this.bindCustomEvents(),this.render()},e.prototype.bindCustomEvents=function(){this.sandbox.on("sulu.toolbar.delete",function(){this.sandbox.emit("husky.datagrid.items.get-selected",function(a){this.sandbox.emit("sulu.snippets.snippets.delete",a)}.bind(this))},this),this.sandbox.on("sulu.toolbar.add",function(){this.sandbox.emit("sulu.snippets.snippet.new")},this),this.sandbox.on("husky.datagrid.number.selections",function(a){var b=a>0?"enable":"disable";this.sandbox.emit("sulu.header.toolbar.item."+b,"deleteSelected",!1)}.bind(this))},e.prototype.render=function(){this.sandbox.dom.html(this.$el,d),this.sandbox.sulu.initListToolbarAndList.call(this,"snippets","/admin/api/snippet/fields",{el:this.$find("#list-toolbar-container"),instanceName:"snippets"},{el:this.sandbox.dom.find("#snippet-list",this.$el),url:"/admin/api/snippets?language="+this.options.language,searchInstanceName:"snippets",storageName:"snippets",searchFields:["title"],resultKey:"snippets",actionCallback:function(a,d){d.type&&"ghost"===d.type.name?c.openGhost.call(this,d,this.translations.openGhostOverlay).then(function(c,e){c?b.copyLocale.call(this,d.id,e,[this.options.language],function(){this.sandbox.emit("sulu.snippets.snippet.load",a)}.bind(this)):this.sandbox.emit("sulu.snippets.snippet.load",a)}.bind(this)):this.sandbox.emit("sulu.snippets.snippet.load",a)}.bind(this),viewOptions:{table:{badges:[{column:"title",callback:function(a,b){return a.type&&"ghost"===a.type.name&&a.type.value!==this.options.language?(b.title=a.type.value,b):!1}.bind(this)}]}}})},new e});